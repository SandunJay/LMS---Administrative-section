function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}var brandquizEmbed=brandquizEmbed||{};brandquizEmbed.baseurl="https://app.involve.me",brandquizEmbed.divSelector=".brandquiz_embed, .involveme_embed",brandquizEmbed.embeds=[],brandquizEmbed.init=function(){this.oneTimeInit(),this.polyfills();var e=document.querySelector(this.divSelector);e&&e.getAttribute("data-baseurl")&&(this.baseurl=e.getAttribute("data-baseurl")),this.embed()},brandquizEmbed.oneTimeInit=function(){if(!this.initialized){if(this.initialized=!0,document.getElementsByTagName("meta").viewport)document.getElementsByTagName("meta").viewport.content="width=device-width, initial-scale=1, maximum-scale=1";else{var e=document.createElement("meta");e.setAttribute("name","viewport"),e.setAttribute("content","width=device-width, initial-scale=1, maximum-scale=1"),document.querySelector("head").appendChild(e)}window.postMessage&&window.addEventListener("message",function(e){if("object"===_typeof(e.data)&&"involveme_embed"===e.data.source){var t=e.data.sourceId,i=document.querySelector("iframe#"+t);if(void 0===t||null===i)return void this.sendFrameIds();switch(e.data.type){case"scrollToTop":(null===i.parentNode.getAttribute("data-autoscroll")||"true"===i.parentNode.getAttribute("data-autoscroll"))&&!this.isElementInViewport(i)&&i.scrollIntoView();break;case"outerHeight":this.setHeight(i,e.data.payload);break;case"visibleRectangle":this.updateVisibleRectangle(i);break;default:console.log("Parent received a message",e)}}}.bind(this),!1)}},brandquizEmbed.embed=function(){document.querySelectorAll(this.divSelector).forEach(function(e){if(null===e.querySelector("iframe")){var t=e.getAttribute("data-embed")||e.getAttribute("data-project"),i=e.getAttribute("data-baseurl"),o=e.querySelector("script");if(null===i&&o&&(i=new URL(o.src).origin),null===i&&(i=this.baseurl),-1===this.embeds.indexOf(t)){this.embeds.push(t);var n=e.getAttribute("data-width");e.style["max-width"]=n?n+"px":"100%";var r=e.getAttribute("data-min-height"),a=e.getAttribute("data-noresize"),d=e.getAttribute("data-loadcolor"),s=e.getAttribute("data-embed-mode"),l=e.getAttribute("data-embed-tab-position"),u=e.getAttribute("data-embed-is-preview");"fullscreen"===s&&(e.style.height="100%",e.style.width="100%",e.style.margin=0,e.style["line-height"]=0,e.style.position="fixed",e.style["z-index"]=2147483645,e.style.top=0,e.style.left=0,document.getElementsByTagName("body")[0].style="overflow: hidden",a=!0);var c=e.getAttribute("data-params"),m="";null!==c&&c.split(",").forEach((function(e){m+="&"+e}));var h=["src","embed","embedmode","share","noresize","score","calculator","outcome","o","loadcolor"],b=this.getAllUrlParams();for(var p in b)b.hasOwnProperty(p)&&(h.includes(p)||(m+="&"+p+"="+b[p]));a&&(e.style.height="100%",e.style["-webkit-overflow-scrolling"]="touch",r||(e.style.height="100%"));var y=document.createElement("iframe");y.setAttribute("frameborder","0"),y.style.width="100%",y.style.overflow="hidden",["popup","chatButton"].includes(s)&&(y.style["border-radius"]="0.5rem"),["sideTab"].includes(s)&&("left"===l?(y.style["border-top-right-radius"]="0.5rem",y.style["border-bottom-right-radius"]="0.5rem"):"right"===l&&(y.style["border-top-left-radius"]="0.5rem",y.style["border-bottom-left-radius"]="0.5rem")),y.id="_"+Math.random().toString(36).substr(2,9),a&&(y.style.height="100%"),r&&(y.style["min-height"]=r+"px"),u&&(y.style.transform="scale(0.6)",y.style["transform-origin"]="0 0",y.style.width="167%",y.style.height="167%"),y.src=i+"/"+t+"?embed=1"+(s?"&embedmode="+s:"")+(a?"&noresize=1":"")+(d?"&loadcolor="+encodeURIComponent(d):"")+"&src="+encodeURIComponent(document.location.href)+m,e.appendChild(y);var g=e.querySelector("iframe#"+y.id);g.onload=function(){brandquizEmbed.sendFrameId(g)},a||this.makeResponsive(e.querySelector("iframe#"+y.id))}}}.bind(this))},brandquizEmbed.sendFrameIds=function(){document.querySelectorAll(this.divSelector).forEach(function(e){var t=e.querySelector("iframe");t&&t.id&&this.sendFrameId(t)}.bind(this))},brandquizEmbed.sendFrameId=function(e){e.contentWindow.postMessage({source:"involveme_parent",type:"setId",payload:e.id},"*")},brandquizEmbed.ready=function(e){var t=new URL(document.currentScript.src).origin||null;t&&(this.baseurl=t),(document.attachEvent?"complete"===document.readyState:"loading"!==document.readyState)?e():document.addEventListener("DOMContentLoaded",e)},brandquizEmbed.polyfills=function(){window.NodeList&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=Array.prototype.forEach),Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(e,t){if(null==this)throw new TypeError('"this" is null or not defined');var i=Object(this),o=i.length>>>0;if(0===o)return!1;var n,r,a=0|t,d=Math.max(a>=0?a:o-Math.abs(a),0);for(;d<o;){if((n=i[d])===(r=e)||"number"==typeof n&&"number"==typeof r&&isNaN(n)&&isNaN(r))return!0;d++}return!1}})},brandquizEmbed.bringIntoView=function(e){({started:0,ends:0,y:0,tick:function(){var e,t,i,o;(i=Date.now())<this.ends?(e=i-this.started,t=this.ends-this.started,o=(this.y-document.body.scrollTop)*(e/t),document.body.scrollTop+=o,window.requestAnimationFrame(this.tick.bind(this))):document.body.scrollTop=this.y},bringIntoView:function(e,t){this.started=Date.now(),this.ends=this.started+t,this.y=Math.min(document.body.scrollTop+e.getBoundingClientRect().top,document.body.scrollHeight-window.innerHeight),window.requestAnimationFrame(this.tick.bind(this))}}).bringIntoView(e,600)},brandquizEmbed.targetHeight={},brandquizEmbed.updateVisibleRectangle=function(e){var t={top:0,height:0},i=e.getBoundingClientRect();i.top<window.innerHeight&&i.bottom>0&&(i.top<0&&(t.top=Math.abs(i.top)),i.bottom<=window.innerHeight?t.height=i.height-t.top:i.top<0?t.height=window.innerHeight:t.height=window.innerHeight-i.top),e.contentWindow.postMessage({source:"involveme_parent",type:"visibleRectangle",payload:{top:Math.floor(t.top),height:Math.floor(t.height)}},"*")},brandquizEmbed.setHeight=function(e,t){var i=e.parentNode.getAttribute("data-min-height");i&&t<i&&(t=i),t!==this.targetHeight[e.id]&&(this.targetHeight[e.id]=t,e.style.height=t+"px",e.contentWindow.postMessage({source:"involveme_parent",type:"setBodyClass",payload:"minheight"},"*"),this.updateVisibleRectangle(e))},brandquizEmbed.makeResponsive=function(e){e.style.height="300px",e.style["transition-duration"]="600ms",e.style["-webkit-transition-duration"]="600ms",this.targetHeight[e.id]=0},brandquizEmbed.getAllUrlParams=function(e){var t=e?e.split("?")[1]:window.location.search.slice(1),i={};if(t)for(var o=(t=t.split("#")[0]).split("&"),n=0;n<o.length;n++){var r=o[n].split("="),a=r[0],d=void 0===r[1]||r[1];if((a=a.toLowerCase()).match(/\[(\d+)?\]$/)){var s=a.replace(/\[(\d+)?\]/,"");if(i[s]||(i[s]=[]),a.match(/\[\d+\]$/)){var l=/\[(\d+)\]/.exec(a)[1];i[s][l]=d}else i[s].push(d)}else i[a]?i[a]&&"string"==typeof i[a]?(i[a]=[i[a]],i[a].push(d)):i[a].push(d):i[a]=d}return i},brandquizEmbed.isElementInViewport=function(e){var t=e.getBoundingClientRect();return t.top>=0&&t.top<=(window.innerHeight||document.documentElement.clientHeight)},brandquizEmbed.ready((function(){brandquizEmbed.init()}));
